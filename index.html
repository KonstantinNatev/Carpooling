<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8" />
  <title>Leaflet –ö–∞—Ä—Ç–∞ - –°–æ—Ñ–∏—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="./templates/legend/legendTemplate.styles.css" />
  <link rel="stylesheet" href="./templates/schedule/scheduleTemplate.styles.css" />
  <link rel="stylesheet" href="./templates/popUp/popUpTemplate.styles.css" />
  <link rel="stylesheet" href="./index.styles.css" />

  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    .highlight-route {
      color: #007bff;
      text-decoration: underline;
      cursor: pointer;
    }
    .leaflet-popup-content {
      font-family: system-ui, sans-serif;
      font-size: 14px;
      line-height: 1.4;
    }
    .popup-route {
      margin-bottom: 0.75em;
      padding: 0.5em;
      border-left: 3px solid #007bff;
      background: #f7f9fc;
      border-radius: 4px;
    }
    .popup-route b {
      color: #333;
    }
    .highlight-route:hover {
      text-decoration: underline;
      color: #0056b3;
    }
    hr {
      border: none;
      border-top: 1px solid #ccc;
      margin: 0.75em 0;
    }
  </style>
</head>

<body>
  <div id="map"></div>

  <div id="schedule-panel" style="display: none; position: fixed; top: 0; right: 0; width: 340px; height: 100vh; background: #f9f9f9; border-left: 1px solid #e0e0e0; overflow-y: auto; z-index: 1002; box-shadow: -4px 0 12px rgba(0, 0, 0, 0.1); padding: 24px 16px 16px 16px; font-family: sans-serif;">
    <button onclick="document.getElementById('schedule-panel').style.display='none'" style="position: absolute; top: 12px; right: 12px; background: transparent; border: none; font-size: 20px; cursor: pointer; color: #555;" aria-label="Close">‚úñ</button>
    <h2 style="margin-top: 0; font-size: 20px; font-weight: 600; color: #333">–†–∞–∑–ø–∏—Å–∞–Ω–∏–µ</h2>
    <div id="schedule-content" style="margin-top: 16px"></div>
  </div>

  <div id="filter-panel" style="
    position: absolute;
    top: 20px;
    right: 20px;
    background: white;
    padding: 12px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    z-index: 1001;
    font-family: sans-serif;
    width: 220px;
    font-size: 14px;
  ">
    <strong style="display: block; margin-bottom: 8px;">–§–∏–ª—Ç—Ä–∏—Ä–∞–π –ø–æ —Ç–∏–ø –º–∞—Ä—à—Ä—É—Ç:</strong>
    <div style="margin-bottom: 10px;">
      <label style="display:block; margin-bottom: 6px;">
        <input type="checkbox" class="route-type" value="tram" checked /> üöã –¢—Ä–∞–º–≤–∞–π
      </label>
      <label style="display:block; margin-bottom: 6px;">
        <input type="checkbox" class="route-type" value="trolleybus" checked /> üöé –¢—Ä–æ–ª–µ–π–±—É—Å
      </label>
      <label style="display:block;">
        <input type="checkbox" class="route-type" value="bus" checked /> üöå –ê–≤—Ç–æ–±—É—Å
      </label>
    </div>
  </div>

  <div id="debbug-panel" style="position: absolute; top: 10px; left: 60px; z-index: 1001; background: #fff; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); padding: 16px 14px; width: 220px; font-family: 'Segoe UI', sans-serif; font-size: 14px; line-height: 1.5;">
    <h3 style="margin-top: 0; font-size: 15px; color: #333; margin-bottom: 12px">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

    <label for="pointSizeInput" style="display: block; margin-bottom: 6px">–†–∞–∑–º–µ—Ä –Ω–∞ —Å–ø–∏—Ä–∫–∏—Ç–µ:</label>
    <input type="number" id="pointSizeInput" value="5" min="1" max="20" style="width: 90%; padding: 6px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px;" />

    <label for="lineWeightInput" style="display: block; margin-bottom: 6px">–î–µ–±–µ–ª–∏–Ω–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç:</label>
    <input type="number" id="lineWeightInput" value="2" min="1" max="10" style="width: 90%; padding: 6px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px;" />

    <label for="highlightWeightInput" style="display: block; margin-bottom: 6px">–î–µ–±–µ–ª–∏–Ω–∞ –Ω–∞ –∏–∑–±—Ä–∞–Ω –º–∞—Ä—à—Ä—É—Ç:</label>
    <input type="number" id="highlightWeightInput" value="6" min="1" max="15" style="width: 90%; padding: 6px; margin-bottom: 16px; border: 1px solid #ccc; border-radius: 4px;" />

    <button id="applySettingsBtn" style="width: 100%; padding: 8px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">–ü—Ä–∏–ª–æ–∂–∏</button>
  </div>


  <div id="info-panel" class="info-panel">
    <div class="info-panel-header">
      <h3>–ü–∞–Ω–µ–ª —Å —Ç–∞–±–æ–≤–µ</h3>
      <div class="tab-nav">
        <button class="tab-btn active" data-tab="tab-stop">üõë –°–ø–∏—Ä–∫–∞</button>
        <button class="tab-btn" data-tab="tab-extra">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
      </div>
    </div>
    <div class="info-panel-content">
      <div id="tab-stop" class="tab-content active">
        <h4 id="stop-name">–ò–º–µ –Ω–∞ —Å–ø–∏—Ä–∫–∞</h4>
        <div id="stop-info-content" class="stop-panel-content">
          <!-- –¥–∏–Ω–∞–º–∏—á–Ω–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ –∑–∞ —Å–ø–∏—Ä–∫–∞ -->
        </div>
      </div>
      <div id="tab-extra" class="tab-content">
        <h4 class="route-search-title">üîç –¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç</h4>
      
        <form id="route-search-form" class="route-search-form">
          <div class="form-group">
            <label for="start-stop" class="form-label">–ù–∞—á–∞–ª–Ω–∞ —Å–ø–∏—Ä–∫–∞:</label>
            <input type="text" id="start-stop" class="form-input" placeholder="–Ω–∞–ø—Ä. –û—Ä–ª–æ–≤ –º–æ—Å—Ç" />
          </div>
      
          <div class="form-group">
            <label for="end-stop" class="form-label">–ö—Ä–∞–π–Ω–∞ —Å–ø–∏—Ä–∫–∞:</label>
            <input type="text" id="end-stop" class="form-input" placeholder="–Ω–∞–ø—Ä. –¶–µ–Ω—Ç—Ä–∞–ª–Ω–∞ –≥–∞—Ä–∞" />
          </div>
      
          <div class="form-row">
            <button type="button" id="reverse-direction-btn" class="action-btn secondary flex-1">üîÅ –†–∞–∑–º–µ–Ω–∏ —Å–ø–∏—Ä–∫–∏—Ç–µ</button>
            <input type="hidden" id="direction-select" value="auto" />
          </div>
      
          <button type="submit" class="action-btn submit-btn">üîé –ù–∞–º–µ—Ä–∏ –º–∞—Ä—à—Ä—É—Ç</button>
        </form>
      
        <div id="route-search-result" class="route-search-result"></div>
      </div>
      
      
      
    </div>
  </div>
  
  




  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <!-- MarkerCluster JS -->
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

  <!-- Turf -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

  <!-- Custom Scripts -->
  <script src="./utils.js"></script>
  <script src="./templates/legend/legendTemplate.js"></script>
  <script src="./templates/schedule/scheduleTemplate.js"></script>
  <script src="./templates/popUp/popUpTemplate.js"></script>
  <script src="./index.js"></script>
</body>
</html>
